\documentclass[a4paper]{article}

\input{temp}

\setcounter{section}{-2}

\begin{document}

\title{Number Fields}

\maketitle

\newpage

\tableofcontents

\newpage

\section{Miscellaneous}

Book: Number Fields, Marcus

Course notes: www.dpmms.ac.uk/~jat58/nfl2018

\newpage

\section{Motivation}
\begin{thm}
If $p$ is an odd prime, then $p=a^2+b^2$ for $a,b \in \Z \iff p \equiv 1 \pmod 4$.
\begin{proof}
If $p=a^2+b^2$, then $p\equiv 0,1,2 \pmod 4$. So this condition on $p$ is necessary.\\
Suppose instead $p \equiv 1 \pmod 4$. Then $\left(\frac{-1}{p}\right) = 1$. Thus $\exists a \in \Z$ such that $a^2 \equiv -1 \pmod p$, or $p|a^2+1$. We can factor $a^2+1=(a+i)(a-i)$ in the ring $\Z[i]$. Here we introduce a notation: if $R \subseteq S$ are rings and $\alpha \in S$, then $$R[\alpha] = \{\sum_{i=0}^n a_i \alpha^i \in S | a_i \in R\}$$, the smallest subring of $S$ containing both $R$ and $\alpha$.

We know from IB GRM that $\Z[i]$ is a UFD. Now $p|(a+i)(a-i)$. If $p$ is irreducible in $\Z[i]$ then $p|a+i$ or $p|a-i$, contradiction. Thus $p$ is reducible in $\Z[i]$, hence $p=z_1z_2$ with $z_1,z_2 \in \Z[i]$. If $z_1 = A+Bi$, $A,B\in \Z$, then $A^2+B^2 = p$.
\end{proof}
\end{thm}

Another example is when $p$ is an odd prime. Does the equation $$x^p+y^p=z^p$$ have solutions with $x,y,z\in \Z$ and $xyz \neq 0$?

\begin{thm} (Kummer, 1850)\\
If $\Z[e^{2\pi i/p}]$ is a UFD, then there are no solutions.\\
Strategy: factor $x^p+y^p = \prod_{j=0}^{p-1} (x+e^{2\pi ij/p}y)$ in $\Z[e^{2\pi i/p}]$.
\end{thm}

However, we now know $\Z[e^{2\pi i/p}]$ is a UFD $\iff$ $p \leq 19$.

\begin{thm} (Kummer, 1850)\\
If $p$ is a \emph{regular} prime, then there are no solutions.\\
If $p<100$, then $p$ is regular $\iff$ $p \neq 37,59,67$.
\end{thm}

We have seen various examples such as $\Z \subseteq \Q$, $\Z[i] \subseteq \Q[i]$, $\Z[e^{2\pi i/p}] \subseteq \Q[e^{2\pi i/p}]$, or in general, $\mathcal{O}_L\subseteq L$, where a ring of "integers" lies in a number field.

\newpage

\section{Ring of integers}
Recall: A field extension $L/K$ is an inclusion $K \leq L$ of fields. The degree of $L/K$ is $[L:K] = \dim_K L$. We say $L/K$ is finite if $[L:K]<\infty$.

\begin{defi} (1.1)\\
A number field is a finite extension $L/\Q$. Here are two ways to construct number fields:\\
(1) Let $\alpha \in \C$ be an algebraic number. Then $L=\Q(\alpha)$ is a number field;\\
(2) Let $K$ be a number field, and let $f(X) \in K[X]$ be an irreducible polynomial. Then $L=K[X]/(f(X))$ is a number field.\\
(Recall Tower Law: $[L:Q] = [L:K][K:Q] < \infty$).
\end{defi}

\begin{defi} (1.2)\\
(1) Let $L/K$ be a field extension. Then we say $\alpha \in L$ is algebraic over $K$ if there exists a monic $f(X) \in K[X]$ such that $f(\alpha) = 0$;\\
(2) Let $L/\Q$ be a field extension. Then we say $\alpha \in L$ is an algebraic integer if there exists a monic $f(X) \in Z[X]$ such that $f(\alpha) = 0$.
\end{defi}

\begin{defi} (1.3)\\
Let $L/K$ be a field extension, and let $\alpha \in L$ be algebraic over $K$. We call the minimal polynomial of $\alpha$ over $K$ the monic polynomial $f_\alpha(X) \in K[X]$ of least degree such that $f_\alpha(\alpha)=0$.
\end{defi}

We recall why $f_\alpha(X)$ is well-defined: there exists some monic $f(X) \in K[X]$ with $f(\alpha)=0$ as $\alpha$ is algebraic. If $f_\alpha(\alpha),f'_\alpha(\alpha) \in K[X]$ both satisfy the definition of minimal polynomial, then we apply the polynomial division algorithm to write $$f_\alpha(X) = p(X) f'_\alpha(X) + r(X)$$ where $p(X),r(X) \in K[X]$, and $\deg r < \deg f'_\alpha$. Evaluate at $X=\alpha$, we have $0=f_\alpha(\alpha) = p(\alpha)f'_\alpha(\alpha)+r(\alpha)=r(\alpha)$. By minimality of $\deg f'_\alpha$, we must have $r=0$. Then $\deg f_\alpha = \deg f'_\alpha$, and $f_\alpha(X),f'(\alpha)$ are both monic, i.e. $p(X) = 1$ and $f_\alpha(X) = f'_\alpha(X)$.

\begin{lemma}(1.4)\\
Let $L/\Q$ be a field extension, and let $\alpha \in L$ be an algebraic integer. Then:\\
(1) The minimal polynomial $f_\alpha(X)$ of $\alpha$ over $\Q$ lies in $\Z[X]$;\\
(2) If $g(X) \in \Z[X]$ satisfies $g(\alpha) = 0$, then there exists $q(X) \in \Z[X]$ such that $g(X) = f_\alpha(X) q(X)$;\\
(3) The kernel of the ring homomorphism $\Z[X] \to L$ by $f(X) \to f(\alpha)$ equals $(f_\alpha(X))$, the ideal generated by $f_\alpha(X)$.
\begin{proof}
(1) Recall that if $f(X) = a_n X^n + ... + a_0 \in \Z[X]$, then we define from GRM, the content $c(f) = \gcd(a_n,...,a_0)$. Recall Gauss' Lemma: If $f(X), g(X) \in \Z[X]$, then $c(fg) = c(f)c(g)$. Since $\alpha \in L$ is an algebraic integer, there exists monic $f(X) \in \Z[X]$ such that $f(\alpha) = 0$, i.e. $c(f) = 1$. Apply polynomial division in $\Q[X]$ to get $f(X) = p(X) f_\alpha(X) +r(X)$, where $p(X),r(X) \in \Q[X]$, $\deg r < \deg f_\alpha$. The definition of $f_\alpha(X)$ implies that $r(X) = 0$, hence $f(X) = p(X) f_\alpha(X)$. Now choose integers $n,m \geq 1$ such that $np(X) \in \Z[X]$, $c(np) = 1$, and $mf_\alpha(X) \in \Z[x]$, $c(mf_\alpha) = 1$. Then $nmf(x) = (np(x))(mf_\alpha(x)) \implies c(nmf(x)) = nm = 1$. So $n=m=1$, hence $f_\alpha(x) \in \Z[X]$.\\
(2) Let $g(X) \in \Z[X]$ be such that $g(\alpha) =0 $. WLOG $g(x) \neq 0$ and $c(g) = 1$. Now apply polynomial division to write $g(x) = q(x) f_\alpha(x) + s(x)$ where $q(x),s(x) \in \Q[x]$, $\deg s < \deg f_\alpha$. Again by definition we have $s(x) = 0$. Choose an integer $k \geq 1$ such that $kq(x) \in Z[x]$ and $c(kq) =1$. Then $kg(x) = kq(x) f_\alpha(x) \implies k=c(kg) = c(kq) c(f_\alpha) = 1$. So $k=1$, hence $q(x) \in \Z[x]$.\\
(3) is a reformulation of (2).
\end{proof}
\end{lemma}

Let $L/\Q$ be a field extension. Last time we said $\alpha \in L$ is an algebraic integer if $\exists$ monic polynomial $f(x) \in \Z[x]$ such that $f(\alpha) = 0$. We proved that if $\alpha \in L$ is an algebraic integer and $f_\alpha(x) \in \Q[x]$ is the minimal polynomial of $\alpha$ over $\Q$, then $f_\alpha(x) \in \Z[x]$. However there is a small problem, so we'll prove again.
\begin{proof}
Choose $f(x) \in \Z[x]$ monic with $f(\alpha) = 0$, and write $$f(x) = q(x) f_\alpha(x) + r(x)$$ where $q(x),r(x) \in \Q[x]$, $\deg r < \deg f_\alpha$. Then $r(\alpha) = 0 \implies r(x) = 0$, by minimality of $\deg f_\alpha$. I said that we can find integer $n,m \geq 1$ s.t. $nf\alpha(x) \in \Z[x]$, $c(nf\alpha) = 1$, $mq(x) \in \Z[x]$, $c(mq) = 1$. However we need to explain why do they exist. Note $f_\alpha(x)$ and $q(x)$ are both monic. Choose integers $N,M \geq 1$ such that $Nf_\alpha(x) \in \Z[x]$, $Mq(x) \in \Z[x]$. Then $c(Nf_\alpha) | N$, $c(Mq)|M$ as those are the leading term of the polynomial. Now let $N/c(Nf\alpha) = n \in \Z$, $M/c(Mq) = m \in \Z$. Now $nmf(x) = (nf\alpha(x)) (mq(x))$, so $c(nmf(x)) = nm = 1 \implies n=m=1$.
\end{proof}

\begin{coro} (1.5)\\
If $\alpha \in \Q$, then $\alpha$ is an algebraic integer $\iff$ $\alpha \in \Z$.
\begin{proof}
By lemma 1.4, $\alpha$ is an algebraic integer $\iff f_\alpha(x) \in \Z[x]$. But if $\alpha \in \Q$, then $f_\alpha(x) = x-\alpha$, and the first needs to divide the second polynomial.
\end{proof}
\end{coro}

\begin{notation}
If $L/\Q$ is any field extension, we write $\mathcal{O}_L =\{\alpha \in L | \alpha$ is an algebraic integer$\}$.
\end{notation}

Now we proceed to the first non-trivial result of the course:

\begin{prop} (1.6)\\
If $L/\Q$ is a field extension, $\mathcal{O}_L$ is a ring.
\begin{proof}
Clearly $0,1 \in \mathcal{O}_L$. Now if $\alpha \in \mathcal{O}_L$, then $f_{-\alpha}(x) = (-1)^{\deg f_\alpha} f_\alpha (-x) \implies -\alpha \in \mathcal{O}_L$.\\
The hard part is to show that if $\alpha,\beta \in \mathcal{O}_L$, then $\alpha+\beta \in \mathcal{O}_L$ and $\alpha\beta \in \mathcal{O}_L$.\\
Observe that if $\alpha \in \mathcal{O}_L$, then $\Z[\alpha] \subseteq L$ is a finitely generated $\Z$-module. By definition, $\Z[\alpha]$ is generated by $1,\alpha,\alpha^2,\alpha^3,...$. Let $f_\alpha(x) = x^d + a_1 x^{d-1} + ... + ad$, $a_i \in \Z$. Then $\alpha^d = -(a_1 \alpha^{d-1} + ... + ad)$, so $\alpha^d \in \sum_{i=0}^{d-1} \Z \alpha^i$. By induction, we see that $\alpha^n \in \sum_{i=0}^{d-1} \Z \alpha^i$ for all $n \geq d$. Hence $\Z[\alpha] = \sum_{i=0}^{d-1} \Z \alpha^i$. Now take $\alpha,\beta \in \mathcal{O}_L$ and let $d = \deg f_\alpha$, $e = \deg f_\beta$.\\
By definition, $\Z[\alpha,\beta] =\Z[\alpha][\beta]$ is generated as a $\Z$-module by $\{\alpha^i\beta^j\}_{i,j \in \N}$. The same argument show that in fact this ring is generated as a $\Z$-module by $\{\alpha^i \beta^j\}$ for $0\leq i\leq d-1, 0 \leq j \leq e-1$. So $\Z[\alpha,\beta]$ is finitely generated. From GRM we know the classification of finitely generated $\Z$-modules implies that there's an isomorphism $\Z[\alpha,\beta] \cong \Z^r \oplus T$ for some $r \geq 1$ and finite abelian group $T$. In fact, $T=0$: if $\gamma \in T$, then $|T|\gamma = 0$, by Lagrange's theorem. But $\Z[\alpha,\beta] \subseteq L$, a $\Q$-vector space, so this forces $\gamma = 0$. Now we can therefore fix an isomorphism $\Z[\alpha,\beta] \cong \Z^r$ ($r \geq 1$. There's an endomorphism $m_{\alpha\beta}: \Z[\alpha,\beta] \to \Z[\alpha,\beta]$ by $\gamma \to \alpha\beta\gamma$ (as a $\Z$-module). $m_{\alpha\beta}$ corredponds to an $r \times r$ matrx $A_{\alpha\beta} \in M_{r \times r} (\Z)$.\\
Let $F_{\alpha\beta}(x) = \det (x\cdot 1_r -A_{\alpha\beta}) \in \Z[x]$, a monic polynomial. By the Cayley-Hamilton theorem, $F_{\alpha\beta}(m_{\alpha\beta}) = 0$ as endomorphisms of $\Z[\alpha,\beta]$. Write $F_{\alpha\beta}(x) = x^r + b_1x^{r-1} + ... + b_r$ for $b_i \in \Z$. Thus $m^r_{\alpha\beta} + b_1 m^{r-1}_{\alpha\beta} + ... + b_r \cdot 1_r = 0$ as endomorphisms of $\Z[\alpha,\beta]$.\\
Now the image of $1$ is $(\alpha\beta)^r+b_1(\alpha\beta)^{r-1} + ... + b_r = F_{\alpha\beta}(\alpha\beta) = 0$. So $\alpha\beta \in \mathcal{O}_L$.\\
The argument to show $\alpha+\beta \in \mathcal{O}_L$ is identical, replacing $m_{\alpha\beta}$ by $m_{\alpha+\beta}: \Z[\alpha,\beta] \to \Z[\alpha,\beta]$ by $\gamma \to (\alpha+\beta)\gamma$. The detail is omitted here.
\end{proof}
\end{prop}

We call $\mathcal{O}_L$ the ring of algebraic integers of $L$.

\begin{lemma} (1.7)\\
Let $L/\Q$ be a number field, and let $\alpha \in L$. Then $\exists n \geq 1$ an integer such that $n\alpha \in \mathcal{O}_L$.
\begin{proof}
Let $f(x) \in \Q[x]$ be a monic polynomial such that $f(\alpha) = 0$. Then $\exists n\in \Z, n \geq 1$ such that $g(x) = n^{\deg f} f(x/n) \in \Z[x]$ is monic. But then $g(n\alpha) = n^{\deg f} f(\alpha) = 0$. So $n\alpha \in \mathcal{O}_L$.
\end{proof}
\end{lemma}

\newpage

\section{Complex embeddings}
Let $L$ be a number field.
\begin{defi} (2.1)\\
A \emph{complex embedding} of $L$ is a field homomorphism $\sigma: L \to \C$. Note: in this case, $\sigma$ is injective, and $\sigma|_\Q$ is the usual embedding $\Q \to \C$.
\end{defi}

\begin{prop} (2.2)\\
Let $L/K$ be an extension of number fields, and let $\sigma_0:K \to \C$ be a complex embedding. Then there exist exactly $[L:K]$ embeddings $\sigma:L \to \C$ which extends $\sigma_0$ ($\sigma|_K = \sigma_0$).
\begin{proof}
Induction on $[L:K]$. If $[L:K] = 1$, then $L=K$, so $\sigma_0$ determines $\sigma$.\\
In general, choose $\alpha \in L-K$ and consider $L/K(\alpha)/K$. By the Tower law, $[L:K] = [L:K(\alpha)][K(\alpha):K]$ and $[K(\alpha):K]>1$. By induction, it's enough to show there are exactly $[K(\alpha):K]$ embeddings $\sigma:K(\alpha) \to \C$ extending $\sigma_0$.\\
Let $f_\alpha(x) \in K[x]$ be the minimal polynomial of $\alpha$ over $K$. Observe there's an isomorphism $K[x] / (f_\alpha(x)) \to K(\alpha)$ by sending $x \to \alpha$. To give a complex embedding $\sigma:K(\alpha) \to \C$ extending $\sigma_0$, it's equivalent to give a root $\beta$ of $(\sigma_0 f)(x)$ in $\C$ ($\sigma_0 f(x) \in \C[x]$ means apply $\sigma_0$ to the coefficients of $f(x)$). Dictionary: $\sigma \to \beta = \sigma (\alpha)$. We have $[K(\alpha):K] = \deg f_\alpha = \deg \sigma_0 f_\alpha$. It's enough to show $\sigma_0 f_\alpha$ has distinct roots in $\C$. The polynomial $f_\alpha(x) \in K[x]$ is irreducible, so is prime to its derivative $f'_\alpha(x)$ ($char\ K =0$). So $\alpha$ is separable over $K$.
\end{proof}
\end{prop}

Recall from last lecture, let $L$ be a number field, a complex embedding is a field homomorphism $\sigma:L \to \C$. The number of such embeddings is $[L:\Q$]. If $L = \Q(\alpha)$, and $f_\alpha(x) \in \Q[x]$ is the minimal polynomial, then there is a bijection $\{\sigma:L \to \C \} \leftrightarrow \{$ roots $\beta \in \C$ of $f_\alpha(x)\}$ by sending $\sigma \to \beta = \sigma(alpha)$.

Notation: if $\sigma:L \to \C$ is a complex embedding, then $\bar{\sigma} : L \to \C$ is also a complex embedding, where $\bar{\sigma}(\alpha) = \overline{\sigma(\alpha)}$ (complex conjugation). If $\sigma = \bar{\sigma}$, then $\sigma(L) \subseteq \R$. Otherwise $\sigma \neq \bar{\sigma}$ and $\sigma(L) \not\subseteq \R$.

We write $r$ for the number of complex embedding $\sigma$ such that $\sigma = \bar{\sigma}$, $s$ for the number of pairs of embeddings $\{\sigma,\bar{\sigma}\}$ where $\sigma \neq \bar{\sigma}$. Then $r+2s = [L:\Q]$.

\begin{eg}
Let $d \in \Z$ be square-free, $d \neq 0,1$. Let $\Q(\sqrt{d}) = \Q[x] / (x^2-d)$. If $d>0$, then $r=2,s=0$ (real quadratic field).\\
If $d<0$, then $r=0,s=1$ (imaginary quadratic field).
\end{eg}

\begin{eg}
Let $m \in \Z$ cube-free, $m \neq 0,1,-1$. Let $\Q(\sqrt[3]{m}) =\Q[x]/(x^3-m)$. Then $r=1,s=1$, since $x^3-m$ has one real and two complex roots.
\end{eg}

\begin{defi} (2.3)\\
Let $L/K$ be an extension of number fields, and let $\alpha \in L$. Let $m_\alpha:L\to L$ be the $K$-linear map defined by $m_\alpha(\beta) = \alpha\beta$. Then we define
\begin{equation*}
\begin{aligned}
\tr_{L/K}(\alpha) = \tr m_\alpha \in K\\
N_{L/K}(\alpha) = \det m_\alpha \in K
\end{aligned}
\end{equation*}
the trace and norm of $\alpha$ respectively.
\end{defi}

\begin{lemma} (2.4)\\
If $L/K$ is an extension of number fields and $\alpha \in L$, then 
\begin{equation*}
\begin{aligned}
\tr_{L/K}(\alpha) = [L:K(\alpha)] \tr_{K(\alpha)/K}(\alpha)\\
N_{L/K}(\alpha) = N_{K(\alpha)/K} (\alpha)^{[L:K(\alpha)]}
\end{aligned}
\end{equation*}
\begin{proof}
There's an isomorphism $L \cong K(\alpha)^{[L:K(\alpha)]}$ of $K(\alpha)$-vector spaces(?).
\end{proof}
\end{lemma}

\begin{lemma} (2.5)\\
Let $L/K$ be an extension of number fields and let $\alpha \in L$. Let $\sigma_0:K \to \C$ be a complex embedding, and let $\sigma_1,...,\sigma_n:L \to \C$ be the embeddings of $L$ extending $\sigma_0$.\\
Then 
\begin{equation*}
\begin{aligned}
\sigma_0(\tr_{L/K} (\alpha)) = \sigma_1(\alpha) + ... + \sigma_n(\alpha)\\
\sigma_0(N_{L/K}(\alpha)) = \sigma_1(\alpha)...\sigma_n(\alpha).
\end{aligned}
\end{equation*}
\begin{proof}
WLOG let $L=K(\alpha)$. Let $f_\alpha(x) \in K[x]$ be the minimal polynomial of $\alpha$ over $K$. Then $$(\sigma_0 f_\alpha)(x) = (x-\sigma_1(\alpha))(x-\sigma_2(\alpha))...(x-\sigma_n(\alpha))$$
If $f(\alpha) = x^n+a_1x^{n-1}+...+a_n$, then $\sigma_0(a_1) = -(\sigma_1(\alpha)+...+\sigma_n(\alpha))$, $\sigma_0(a_n) = (-1)^n \sigma_1(\alpha)...\sigma_n(\alpha)$.\\
Let $g(x) \in K[x]$ be the characteristic polynomial of $m_\alpha$. If $g(x) = x^n+b_1x^{n-1}+...+b_n$, then $b_1 = -\tr m_\alpha = -\tr_{L/K}(\alpha)$, $b_n = (-1)^n \det m_\alpha = (-1)^n N_{L/K}(\alpha)$.By Cayley-Hamilton, $g(m_\alpha) = 0 \implies g(\alpha) = 0 \implies f_\alpha(x) = g(x)$.
\end{proof}
\end{lemma}

\begin{coro} (2.6)\\
If $\alpha \in \mathcal{O}_L$, then $\tr_{L/K}(\alpha)$, $N_{L/K}(\alpha) \in \mathcal{O}_K$.
\begin{proof}
If $\beta \in K$ then $\beta \in \mathcal{O}_K$ $\iff$ $\sigma_0(\beta) \in \mathcal{O}_\C$ (as $\forall f(x) \in \Z[x], f(\beta) = 0 \iff f(\sigma_0(\beta)) = 0$).\\
By the lemma, $\sigma_0 \tr_{L/K} (\alpha) = \sigma_1(\alpha)+...+\sigma_n(\alpha)$. If $\alpha \in \mathcal{O}_L$, then $\sigma_1(\alpha),...,\sigma_n(\alpha) \in \mathcal{O}_\C \implies \sigma_1(\alpha)+...+\sigma_n(\alpha) \in \mathcal{O}_\C$ $\implies \sigma_0 \tr_{L/K}(\alpha) \in \mathcal{O}_\C$ $\implies \tr_{L/K}(\alpha) \in \mathcal{O}_K$.

The same argument works for the norm.
\end{proof}
\end{coro}

\begin{prop} (2.7)\\
Let $d \in \Z$ be squarefree, $d \neq 0,1$, and let $L = \Q(\sqrt{d})$. Then 
\begin{equation*}
\begin{aligned}
\mathcal{O}_L = \left\{\begin{array}{ll}
\Z[\sqrt{d}] & d \equiv 2,3 \pmod 4\\
\Z[\frac{1+\sqrt{d}}{2} & d \equiv 1 \pmod 4
\end{array}
\right.
\end{aligned}
\end{equation*}
\begin{proof}
If $\alpha \in L$, then $\alpha \in \mathcal{O}_L$ if and only if both trace and norm (over $L/\Q$) of $\alpha$ is in $\Z$. Why? Forward direction is the previous corollary; if $\alpha \in L$, then $f(\alpha) = 0$, where $f(x) = (x-\sigma_1(\alpha))(x-\sigma_2(\alpha)) = x^2 - \tr_{L/\Q}(\alpha)x+N_{L/\Q}(\alpha) \in \Q[x]$, where $\sigma_1,\sigma_2$ are complex embeddings of $L$. So backward holds too.

Let $\alpha \in L$. Write $\alpha = \frac{u}{2} + \frac{v}{2}\sqrt{d}$ where $u,v \in \Q$. If $\alpha \in \mathcal{O}_L$, then $\tr_{L/\Q}(\alpha) = u \in \Z$, and $N_{L/\Q}(\alpha) = \frac{1}{4} (u+\sqrt{d} v) (u-\sqrt{d} v) = \frac{1}{4} (u^2-dv^2) \in \Z$ $\implies u^2-dv^2 \in 4\Z$ $\implies dv^2\in\Z$.\\
Write $v=\frac{r}{s}$ where $r,s \in \Z, s \neq 0, (r,s) = 1$. Then we get $dr^2 \in s^2\Z$ $\implies s^2 | dr^2$.\\
If $p$ is a prime and $p|s$ then $p^2|d$. But we assumed $d$ is square-free. So $s=1$, so $v \in \Z$.

We've shown if $\alpha \in \mathcal{O}_L$, then $\alpha = \frac{u}{2} + \frac{v}{2}\sqrt{d}$ where $u,v \in \Z$ and $u^2 \equiv d^2 \pmod 4$.\\

Case 1: $d \equiv 2,3 \pmod 4$. Then $u^2,v^2 \equiv 0,1 \pmod 4$. Considering the congruence $u^2\equiv dv^2 \pmod 4$ shows that both $u,v \in 2\Z$. Hence $\alpha \in \Z[\sqrt{d}] = \{a+b\sqrt{d} | a,b \in \Z\}$, and $\mathcal{O}_L = \Z[\sqrt{d}]$.

Case 2: $d \equiv 1 \pmod 4$. Hence $u^2\equiv v^2 \pmod 4$, so $u \equiv v \pmod 2$. Hence $\mathcal{O}_L \subseteq \{\frac{u}{2}+\frac{v}{2}\sqrt{d} | u,v \in \Z, u \equiv 1 \pmod 2\} =\Z \oplus \Z(\frac{1+\sqrt{d}}{2})$. It remains to show that $\frac{1+\sqrt{d}}{2}$ is an algebraic integer.\\
We have $\tr_{L/\Q}(\frac{1+\sqrt{d}}{2}) = 1$, $N_{L/\Q}(\frac{1+\sqrt{d}}{2}) = \frac{1-d}{4} \in \Z$.
\end{proof}
\end{prop}

Recall that if $R$ is a ring, then a unit in $R$ is an element $u \in R$ such that there exists $v \in R$ such that $uv = 1$.

The set $\R^* = \{u \in R | u $ is a unit$\}$ forms a group under multiplication.

\begin{lemma} (2.8)\\
If $L$ is a number field, then the units in $\mathcal{O}_L$ are $\mathcal{O}_L^* = \{\alpha \in \mathcal{O}_L| N_{L/\Q}(\alpha) = \pm 1\}$.
\begin{proof}
next time.

It's next time now! Let's prove this lemma.\\
$N_{L/\Q}(\alpha\beta)=N_{L/\Q}(\alpha)N_{L/\Q}(\beta)$ for any $\alpha,\beta \in L$.\\
If $\alpha \in \mathcal{O}_L^*$, then $\exists \beta \in \mathcal{O}_L$ such that $\alpha\beta = 1 \implies N_{L/\Q}(\alpha) N_{L/\Q}(\beta) = 1$. Since $N_{L/\Q}(\alpha),N_{L/\Q}(\beta) \in \Z$, we get $N_{L/\Q}(\alpha) \in \{\pm 1\}$.\\
Conversely, suppose $\alpha \in \mathcal{O}_L$ and $N_{L/\Q} (\alpha) = \pm 1$. Then $\alpha^{-1} \in L$. Let $\sigma_1,...,\sigma_n:L \to \C$ be the distinct complex embeddings of $L$. Then 
\begin{equation*}
\begin{aligned}
N_{L/\Q}(\alpha) = \sigma_1(\alpha)...\sigma_n(\alpha) = \pm 1\\
\implies \sigma_1(\alpha^{-1}) = \pm \sigma_2(\alpha)...\sigma_n(\alpha) \in \mathcal{O}_\C\\
\implies \alpha^{-1} \in \mathcal{O}_L
\end{aligned}
\end{equation*}
\end{proof}
\end{lemma}

\begin{rem}
We'll prove later in the course that $\mathcal{O}_L^*$ is a finite group $\iff$ either $L=\Q$ or $L$ is an imaginary quadratic field.
\end{rem}

\newpage

\section{Discriminants and integral bases}
Let $L$ be a number field, $n=[L:\Q]$, $\sigma_1,...,\sigma_n:L \to \C$ be distinct complex embeddings.

\begin{defi} (3.1)\\
Let $\alpha_1,...,\alpha_n \in L$. Then their discriminant is $disc(\alpha_1,...,\alpha_n) = \det(D)^2$, where $D=M_{n\times n}(F)$ is $D_{ij} = \sigma_i (\alpha_j)$. Note: this is independent of the choice of ordering of $\sigma_1,...,\sigma_n$ and $\alpha_1,...,\alpha_n$, as that's just permuting the rows or columns, hence changing only possibly signs; but we took a square in the definition.
\end{defi}

\begin{lemma} (3.2)\\
Let $\alpha_1,...,\alpha_n \in L$. Then $disc(\alpha_1,...,\alpha_n) = \det(T)$, where $T \in M_{n \times n}(\Q)$ is $T_{ij} = \tr_{L/\Q}(\alpha_i\alpha_j)$.
\begin{proof}
$T_{ij} = \sum_{k=1}^n \sigma_k (\alpha_i\alpha_j) = \sum_{k=1}^n D_{ki} D_{kj} = (D^T D)_{ij}$.
\end{proof}
\end{lemma}

\begin{coro} (3.3)\\
$disc(\alpha_1,...,\alpha_n) \in \Q$. If $\alpha_1,...,\alpha_n \in \mathcal{O}_L$, then $disc(\alpha_1,...,\alpha_n) \in \Z$.
\begin{proof}
$disc(\alpha_1,...,\alpha_n) = \det(T)$, and entries of $T$ is trace of some elements of $L$ (over $\Q$) so is in the base field $\Q$ (think a bit). So this must be rational. If $\alpha_1,...,\alpha_n \in \mathcal{O}_L$, then $\forall i,j$, $D_{ij} \in \mathcal{O}_\C \implies disc(\alpha_1,...,\alpha_n) \in \mathcal{O}_\C \cap \Q =\Z$.
\end{proof}
\end{coro}

\begin{prop} (3.4)\\
Let $\alpha_1,...,\alpha_n \in L$. Then $disc(\alpha_1,...,\alpha_n) \neq 0 \iff \alpha_1,...,\alpha_n$ form a basis of $L$ as $\Q$-vector space.\\
\begin{proof}
First suppose $\alpha_1,...,\alpha_n$ are linearly dependent. Then the columns of the matrix $D_{ij} = \sigma_i(\alpha_j)$ are linearly depnedent $\implies disc(\alpha_1,...,\alpha_n) = 0$ (determinant is 0).\\
Now suppose $\alpha_1,...,\alpha_n$ are linearly independent. Then $disc(\alpha_1,...,\alpha_n) \neq 0$ $\iff \det (T) \neq 0$ $\iff$ the symmetric bilinear form $\phi:L \times L \to \Q$ by $\phi(\alpha,\beta) = \tr_{L/\Q}(\alpha\beta)$ is non-degenerate, i.e. $\forall \alpha \in L^*, \exists \beta \in L$ such that $\phi(\alpha,\beta) \neq 0$.\\
If $\alpha \in L^*$, then $\phi(\alpha,\alpha^{-1}) = \tr_{L/\Q}(1) = n \neq 0$.
\end{proof}
\end{prop}

\begin{defi} (3.5)\\
We say elements $\alpha_1,...,\alpha_n \in L$ form an \emph{integral basis for $\mathcal{O}_L$}, if:\\
(i) $\alpha_1,...,\alpha_n \in \mathcal{O}_L$;\\
(ii) $\alpha_1,...,\alpha_n$ generate $\mathcal{O}_L$ as a $\Z$-module.
\end{defi}

\begin{lemma} (3.6)\\
If $\alpha_1,...,\alpha_n$ form an integral basis for $\mathcal{O}_L$, then the function
\begin{equation*}
\begin{aligned}
f: \Z^n &\to \mathcal{O}_L\\
(m_1,...,m_n) &\to \sum_{i=1}^n m_i\alpha_i
\end{aligned}
\end{equation*}
is an isomorphism of $\Z$-module.
\begin{proof}
$f$ is a homomorphism, we must show it's bijective. Observe that $\alpha_1,...,\alpha_n$ form a basis of $L$ as $\Q$-vector space. We know that if $\beta \in L$, then $\exists N \in \Z^+$ such that $N\beta \in \mathcal{O}_L$ (I think (1.7)). So we can write $N\beta = \sum_{i=1}^n m_i \alpha_i$ for some $m_1 \in \Z$ $\implies \beta = \sum_{i=1}^n \frac{m_i}{N}\alpha_i$. Hence $\alpha_1,...,\alpha_n$ span $L$, so they form a basis of $L$.\\
If $f(m_1,...,m_n) = 0$, then $\sum_{i=1}^n m_i \alpha_i = 0 \implies (m_1,...,m_n) = (0,...,0)$, as $\alpha_1,...,\alpha_n$ are independent over $\Q$. This shows $f$ is injective. It's surjecitve by definition.
\end{proof}
\end{lemma}

\begin{lemma} (3.7, sandwich lemma)\\
(i) If $H \leq G$ are groups and $G \cong \Z^a$ for some $a \geq 0$, then $H \cong \Z^b$ for some $b \leq a$.\\
(ii) If $K \leq H \leq G$ are groups and $K \cong \Z^a$, $G \cong \Z^a$ for some $a \geq 0$, then $H \cong \Z^a$.\\
(iii) If $H \leq G$ are groups and $H \cong \Z^a$, $G \cong \Z^a$ for some $a \geq 0$, then $G/H$ is finite.
\begin{proof}
(i) $H \leq G$, $G \cong \Z^a$. Then $G/H$ is f.g abelian group. By the classification, there's an isomorphism $G/H \cong \Z^N \oplus A$, $A$ finite abelian group. Choose $p$ prime, $p \not\mid |A|$. Then the map $f:G/H \to G/H$ by $x+H \to px + H$ is injective, so $f':H/pH \to G/pG$ by $x+pH \to x+pG$ is injecitve -- why? If $x \in H, x \in pG$, then $x = py$ for some $y \in G$; then $y+H \in \ker(f) =H$. Hence $x \in pH$. So indeed $f'$ is injective. By the classification, $H \cong \Z^b$. $f'$ injective $\implies |H/pH| \leq |G/pG|$, i.e. $p^b \leq p^a$ so $b\leq a$.\\
(ii) Apply (i) to $K \leq H$ and $H \leq G$ to get $H \cong \Z^b$ where $a\leq b\leq a$.\\
(iii) $H \leq G$, $H \cong \Z^a, G \cong \Z^a$. Again $G/H$ is finitely generated, so by the classification $G/H \cong \Z^N \oplus A$ where $A$ is a finite abelian group.\\
Let $p$ be a prime, $p \not\mid |A|$. same proof as in (i) shows that $f':H/pH \to G/pG$ is injecitve. Since $|H/pH| = |G/pG| = p^a$, $f'$ is a group isomorphism $G/H + pG \cong (\Z/p\Z)^N$. There's a surjective homomorphism $G/pG \to G/H+pG$ which has kernel containing the image of $f'$. Hence $G/pG \to G/H + pG$ is surjective with kernel $G/pG$. This forces $N=0$.
\end{proof}
\end{lemma}

Let $L$ be a number field, $n = [L:\Q]$, $\sigma_1,...,\sigma_n:L \to \C$ be distinct complex embeddings; $\alpha_1,...,\alpha_n \in L$, we defined $disc(\alpha_1,...,\alpha_n) = \det(\sigma_i(\alpha_j))^2$. An alternative notation is $\Delta(\alpha_1,...,\alpha_n)$. We also said $\alpha_1,...,\alpha_n$ form an integral basis for $\mathcal{O}_L$ if they generate $\mathcal{O}_L$ as a $\Z$-module.

\begin{prop} (3.8)\\
There exists an integral basis for $\mathcal{O}_L$.
\begin{proof}
Let $\beta_1,...,\beta_n \in L$ be a basis for $L$ as $\Q$-vector space. WLOG, $\beta_1,...,\beta_n \in \mathcal{O}_L$. Then $\mathcal{O}_L \supset \oplus_{i=1}^n \Z \beta_i$.\\
Recall $\phi:L \times L \to \Q$ by sending $(\alpha,\beta) \to \tr_{L/\Q} (\alpha\beta)$ is a non-degenerate symmetric bilinear form (we showed that last time). Let $\beta_1^*,...,\beta_n^*$ be the dual basis. Then $\tr_{L/\Q(\beta_i \beta_j^*)} = \delta_{ij}$ (why?).\\
If $\alpha \in \mathcal{O}_L$, then we can write $\alpha = \sum_{i=1}^n a_i \beta_i^*$ where $a_i \in \Q$. We know $\alpha\beta_i \in \mathcal{O}_L$, hence $\tr_{L/\Q} (\alpha\beta) \in \Z$. However LHS = $\sum_{j=1}^n \tr_{L/\Q} (a_j \beta_j^* \beta_i) = \sum_{j=1}^n a_j \tr_{L/\Q} (\beta_j^* \beta_i) = a_j$. So $\mathcal{O}_L \subseteq \oplus_{i=1}^n \Z \beta_i^*$. By sandwich lemma there is an isomorphism between $\Z^n$ and $\mathcal{O}_L$.
\end{proof}
\end{prop}

If $\alpha_1,...,\alpha_n$, $\beta_1,...,\beta_n$ are both integral bases for $\mathcal{O}_L$, then there exists $A \in M_{n \times n} (\Z)$ such that $\beta_j = \sum_{i=1}^n A_{ij}\alpha_i$ for each $j=1,...,n$. Moreover, we must have $\det(A) \in \{\pm 1\}$, and $A \in GL_n(\Z)$. Then $disc(\beta_1,...,\beta_n) = \det(D')^2$, where $D'_{ij} = \sigma_i(\beta_j), D_{ij} = \sigma_i(\alpha_j)$. We have $D'_{ij} = \sum_{k=1}^n \sigma_i (A_{kj} \alpha_k) = \sum_{k=1}^n \sigma_i (\alpha_k) A_{kj} = (DA)_{ij}$.

We find $disc(\beta_1,...,\beta_n) = \det(D')^2 = \det(DA)^2 = \det(D)^2 = disc(\alpha_1,...,\alpha_n)$. Therefore we could define:

\begin{defi} (3.9)\\
The discriminant $D_L$ of the number field $L$ is $disc(\alpha_1,...,\alpha_n)$, where $\alpha_1,...,\alpha_n$ is any integral basis for $\mathcal{O}_L$.
\end{defi}

\begin{prop} (3.10)\\
Let $L=\Q(\alpha)$, and let $f(x) \in \Q[x]$ be the minimal polynomial of $\alpha$ over $\Q$. Then 
\begin{equation*}
\begin{aligned}
disc (1,\alpha,\alpha^2,...,\alpha^{n-1}) = \prod_{i<j} (\sigma_i(\alpha)-\sigma_j(\alpha))^2 = (-1)^{n(n-1)/2} N_{L/\Q}(f'(\alpha))
\end{aligned}
\end{equation*}
In part II Galois theory, we defined the discrimant of a polynomial, $disc f = \prod_{i<j} (\sigma_i(\alpha) - \sigma_j(\alpha))^2$ where $\alpha_i$'s are the roots of $f$.
\begin{proof}
If $D_{ij} = \sigma_i(\alpha^{j-1})$, $D \in M_{n\times n} (\C)$, then $disc(1,\alpha,...,\alpha^{n-1}) = \det(D)^2$. $D$ is a Vandermonde matrix, so we know $\det(D) = \prod_{i<j} (\sigma_j(\alpha) - \sigma_i(\alpha))$.\\
On the other hand, $N_{L/\Q} (f'(\alpha)) = \prod_{i=1}^n \sigma_i (f'(\alpha)) = \prod_{i=1}^n f'(\sigma_i(\alpha))$.\\
Using $f(x) = \prod_{j=1}^n (x-\sigma_j(\alpha))$, we get RHS = $\prod_{i=1}^n \prod_{j \neq i} (\sigma_i(\alpha) - \sigma_j(\alpha)) = (-1)^{n \choose 2} \prod_{i < j} (\sigma_i(\alpha) - \sigma_j(\alpha))^2$.
\end{proof}
\end{prop}

Note: if $\alpha \in \mathcal{O}_L$ and $\Z[\alpha] = \mathcal{O}_L$, then $1,\alpha,...,\alpha^{n-1}$ is an integral basi for $\mathcal{O}_L$. We can then use proposition to calculate $D_L$.

\begin{eg}
Let $d\in \Z$ square-free, $d \neq 0,1$, $L = \Q(\sqrt{d})$. Then 
\begin{equation*}
\begin{aligned}
D_L = \left\{\begin{array}{ll}
4d & d \equiv 2,3 \pmod 4\\
d & d \equiv 1 \pmod 4
\end{array}
\right.
\end{aligned}
\end{equation*}
To see this, if $d \equiv 2,3 \pmod 4$, then $\mathcal{O}_L = \Z[\sqrt{d}]$ (shown previously). Apply proposition to $x^2-d = f(x)$, we get $D_L = disc(1,\sqrt{d}) = -N_{L/\Q}(2\sqrt{d}) = 4d$.\\
On the other hand, if $d \equiv 1 \pmod 4$, then $\mathcal{O}_L = \Z[\frac{1+\sqrt{d}}{2}]$. Apply proposition to the minimal polynomial of this element, $f(x) = x^2-x+\frac{1-d}{4}$, so $f'(x) = 2x-1$, so $f'(\alpha) = \sqrt{d}$. Therefore $D_L = -N_{L/\Q}(\sqrt{d}) = \sqrt{d}$.
\end{eg}

\begin{prop}
If $\alpha_1,...,\alpha_n \in \mathcal{O}_L$ are such that $disc(\alpha_1,...,\alpha_n)$ is a non-zero square-free integer, then $\alpha_1,...,\alpha_n$ form an integral basis for $\mathcal{O}_L$.\\
Note: this is a sufficient condition, but is not necessary (the previous example).\\
\begin{proof}
Let $\beta_1,...,\beta_n$ be an integral basis for $\mathcal{O}_L$. There exists $A \in M_{n \times n} (\Z)$ such that $\alpha_j = \sum_{i=1}^n A_{ij} \beta_i$ $\forall j = 1,...,n$. Then $disc(\alpha_1,...,\alpha_n) = \det(A)^2 disc(\beta_1,...,\beta_n)$ (we proved this in the beginning of lecture: $D'=DA$). In particular, if this is square-free and non-zero, then $\det(A)$ must be $\{\pm 1\}$. So $A \in GL_n(\Z)$. Hence $\alpha_1,...,\alpha_n$ generate $\mathcal{O}_L$ (as they can generate $\beta_i$) and form an integral basis.
\end{proof}
\end{prop}

This could save a lot of calculation if we are lucky.
\begin{eg}
Let $f(x) = x^3-x-1$. Then $disc f = -4a^3 - 27b^2 = -23$. This is square-free! If $L=\Q(\alpha)$, $\alpha$ a root of $f(x)$, then $\mathcal{O}_L = \Z[\alpha]$.
\end{eg}

\begin{defi} (3.12)\\
Let $I \subseteq \mathcal{O}_L$ be a no-zero ideal. Then elements $\alpha_1,...,\alpha_n \in L$ form an integral basis for $I$ if:\\
(i) $\alpha_1,...,\alpha_n \in I$;\\
(ii) $\alpha_1,...,\alpha_n$ generate $I$ as a $\Z$-module.
\end{defi}

\begin{prop} (3.13)\\
Let $I \subseteq \mathcal{O}_L$ be a non-zero ideal. Then there exists an integral basis for $I$.
\begin{defi}
By definition, $I \subseteq \mathcal{O}_L \cong \Z^n$. Let $\alpha_1,...,\alpha_n \in \mathcal{O}_L$ be an integral basis for $\mathcal{O}_L$. Let $\alpha \in I$ be non-zero. Then $(\alpha)\subseteq I$, hence $\oplus_{i=1}^n \Z \alpha \alpha_i \subseteq I \subseteq \mathcal{O}_L$. So by sandwich lemma, there is an isomorphism between $I$ and $\Z^n$ as $\Z$-module. Hence there exists an integral basis for $I$.
\end{defi}
\end{prop}

An interesting consequence of the proof:
\begin{defi} (3.14)\\
If $I \subseteq \mathcal{O}_L$ is a non-zero ideal, then we define its norm
\begin{equation*}
\begin{aligned}
N(I) = [\mathcal{O}_L:I]
\end{aligned}
\end{equation*}
which is finite by the sandwich lemma.
\end{defi}

\begin{defi} (3.15)\\
If $I \subset \mathcal{O}_L$ is a non-zero ideal then we define $disc(I) = disc(\alpha_1,...,\alpha_n)$ where $\alpha_1,...,\alpha_n$ is an integral basis for $I$. (same argument shows $disc(I)$ depends only on $I$).
\end{defi}

\begin{lemma} (3.16)\\
If $I \subseteq \mathcal{O}_L$ is a non-zero ideal, then $disc(I) = disc(\mathcal{O}_L) N(I)^2$.
\begin{proof}
Let $\alpha_1,...,\alpha_n$, $\beta_1,...,\beta_n$ be integral bases for $\mathcal{O}_L$ and $I$ respectively. Then $\exists A \in M_{n \times n} (\Z)$ such that $\beta_j = \sum_{i=1}^n A_{ij} \alpha_i$ $\forall j = 1,...n$, and $disc (\alpha_1,...,\alpha_n) \det(A)^2 = disc(\beta_1,...,\beta_n)$. We must show $\det(A)^2 = [\mathcal{O}_L:I]^2$.

In fact, we'll show if $B \in M_{n \times n} (\Z)$ and $\det(B) \neq 0$, then $|\Z^n / B\Z^n| = |\det(B)|$. This suffices after identify $\mathcal{O}_L \cong \Z^n$.

Recall: $\exists P,Q \in GL_n(\Z)$ such that $PBQ = D = Diag(d_1,...,d_n)$, $d_i \in \Z$ (Smith normal form). Hence we have $\Z^n/B\Z^n \cong \Z^n/D\Z^n \cong \oplus_{i=1}^n \Z/d_i \Z \implies |\Z^n / B\Z^n| = |\Z^n / D\Z^n| = \prod_{i=1}^n |d_i|$.\\
On the other hand, $|\det(B)| = |\det(D)| = \prod_{i=1}^n |d_i|$.
\end{proof}
\end{lemma}

Remember we have $L$ a number field, $n=[L:\Q]$, $\sigma_1,...,\sigma_n:L \to \C$ are distinct complex embeddings of $L$.

\begin{lemma} (3.17)\\
Let $\alpha \in \mathcal{O}_L \setminus\{0\}$. Then $N((\alpha)) = |N_{L/\Q}(\alpha)|$ (Note that's an ideal).
\begin{proof}
Let $\alpha_1,...,\alpha_n$ be an integral basis for $\mathcal{O}_L$. Then $\alpha\alpha_1,...,\alpha\alpha_n$ is an integral basis for $I=(\alpha)$. So
\begin{equation*}
\begin{aligned}
disc(I) &= disc(\alpha\alpha_1,...,\alpha\alpha_n)\\
&= \det(\sigma_i(\alpha\alpha_j))^2\\
&= \det(\sigma_i(\alpha)\sigma_i(\alpha_j))^2\\
&= (\prod_{i=1}^n \sigma_i(\alpha))^2 \det(\sigma_i(\alpha_j))^2\\
&= N_{L/\Q}(\alpha)^2 disc(\mathcal{O}_L)
\end{aligned}
\end{equation*}
And we showed last time that for any non-zero ideal $J \subseteq \mathcal{O}_L$, $disc(J) = N(J)^2 disc(\mathcal{O}_L)$.
\end{proof}
\end{lemma}

Notation: If $\alpha \in \mathcal{L}-\{0\}$, we let $N(\alpha) = N((\alpha)) N(0) = 0$.\\
Then $\forall \alpha,\beta \in \mathcal{O}_L$, $N(\alpha\beta) = N(\alpha)N(\beta)$.

\newpage
\section{Unique factorisation in $\mathcal{O}_L$}
Recall: we say a ring $R$ is a unique factorisation domain (UFD) if\\
(i) $R$ is an integral domain;\\
(ii) if $x \in R$ is non-zero and not a unit, then there exists an expression $x=p_1...p_r$ where $p_i \in R$ are irreducible elements. This expression is unique in the sense that if $x = q_1...q_s$ is another such expression, then $r=s$ and after re-ordering, each $q_i$ is an associate of $p_i$ (i.e. $q_i \in R^* p_i$, where $R^*$ is the field of units).

After 2 years of Cambridge Maths we certainly know $\Z$ is a UFD. However, if $L$ is a number field, $\mathcal{O}_L$ need not be a UFD.

In fact, any non-zero $x \in \mathcal{O}_L$ which is not a unit can be expressed as a product of irreducible elements.

If $x \in \mathcal{O}_L$, then $x$ is a no-zero non-unit $\iff N(x)>1$. Suppose $x \in \mathcal{O}_L$ is a non-zero non-unit which cannot be written as a product of irreducible elements, and with $N(x)$ minimal among elements with this property. Then $x=yz$ with $N(y) >1$, $N(z)>1$, hence $N(y)<N(x)$, $N(z)<N(x)$. By minimality of $N(x)$, both $y,z$ can be written as products of irreducible; contradiction.

\begin{eg}
Consider $L=\Q(\sqrt{-5}$, $\mathcal{O}_L = \Z[\sqrt{-5}]$, and $\mathcal{O}_L^* = \{\pm 1\}$. In $\mathcal{O}_L$ we have $6 = 2 \times 3 = (1+\sqrt{-5})(1-\sqrt{-5})$, and all of the four are irreducibles, and no two are associates (norms). So $\mathcal{O}_L$ is not a UFD (famous example).
\end{eg}

Idea: introduce ideal multiplication in order to reduce elements further.

Recall that if $R$ is a ring and $I,J$ are ideals of $R$, then we define
\begin{equation*}
\begin{aligned}
IJ = \{\sum_{i=1}^k a_ib_i | a_i \in I, b_i \in J\},\\
I+J = \{a+b|a\in I, b \in J\}
\end{aligned}
\end{equation*}
We can define an ideal $I \subsetneq R$ to be irreducible if it does not admit an expression $I=JK$ where $J,K$ are proper ideals of $R$.

Key point: even if $\alpha \in \mathcal{O}_L$ is irreducible, the ideal $(\alpha)$ need not be irreducible. For example in $\Z[\sqrt{-5}]$, we have $(2) = (2,1+\sqrt{-5})^2$, $(3) = (3,1+\sqrt{-5})(3,1-\sqrt{-5})$.

\begin{defi} (4.1)\\
If $R$ is a ring, we say that an ideal $P \subsetneq R$ is prime if $\forall x,y \in R$, $xy \in P$ $\implies x \in P$ or $y \in P$.
\end{defi}

\begin{lemma} (4.2)\\
Let $R$ be a ring, and let $I,J,P \subseteq R$ be ideals, and suppose $P$ is prime and $IJ \subseteq P$. Then $I \subseteq P$ or $J \subseteq P$.
\begin{proof}
WLOG $I \not\subseteq P$. Choose some $x \in I \setminus P$. If $y \in J$, is any element, then $xy \in IJ \subseteq P$. So $y \in P$. So $J \subseteq P$.
\end{proof}
\end{lemma}

From now on, $L$ is a number field.

\begin{lemma} (4.3)\\
Any non-zero prime ideal $P \subseteq \mathcal{O}_L$ is a maximal ideal.
\begin{proof}
Recall: if $R$ is a ring and $I \subsetneq R$ is an ideal, then $I$ is prime $\iff R/I$ is an integral domain, and $I$ is maximal $\iff R/I$ is a field. If you don't remember these statements then I strongly encourage you to review GRM. If $p \subseteq \mathcal{O}_L$ is a non-zero prime ideal, then $\mathcal{O}_L/P$ is a finite integral domain (of cardinality $N(P)$); any such ring is a field, so $P$ is also maximal.
\end{proof}
\end{lemma}

\begin{lemma} (4.4)\\
If $I \subsetneq \mathcal{O}_L$ is a non-zero ideal, then there exist non-zero prime ideals $P_1,...,P_r \subseteq \mathcal{O}_L$ such that $P_1...P_r \subseteq I$.
\begin{proof}
For contradiction, let $I \subsetneq \mathcal{O}_L$ be an ideal whicih does not have this property, and such that $N(I)$ is minimal among ideals not having this property. Then $I$ is not prime, so there exist elements $x,y \in \mathcal{O}_L$ such that $xy \in I$ but $x \not\in I$, $y \not\in I$. But then it follows that $I \subsetneq I+(x)$ and $I \subsetneq I+(y)$. So $N(I+(x)), N(I+(y)) < N(I)$. By minimality of $N(I)$, we can find non-zero prime ideals $P_1...P_r \subseteq I+(x)$ and $Q_1...Q_r \subseteq I+(y)$. Then $P_1 ... P_rQ_1...Q_r \subseteq (I+(x))(I+(y)) \subseteq I^2 +xI+yI+(xy) \subseteq I$. Contradiction.
\end{proof}
\end{lemma}

\begin{lemma} (4.5)\\
If $I \subsetneq \mathcal{O}_L$ is a non-zero ideal, then there exists $\gamma \in L\setminus \mathcal{O}_L$ such that $\gamma I \subseteq \mathcal{O}_L$.
\begin{proof}
Let $\alpha \in I \setminus \{0\}$. Let $P_1,...,P_r \subseteq \mathcal{O}_L$ be non-zero prime ideals such that $P_1...P_r \subseteq (\alpha)$. WLOG $r$ is minimal with this property. Let $P$ be a minimal ideal containing $I$. Then $P \supseteq I \supseteq (\alpha) \supseteq P_1...P_r$, hence $P \supset P_i$ for some $i$. After relabelling assume $P \supset P_1$. Since non-zero prime ideals are maximla, we have $P=P_1$. Since $r$ is minimal, we have $P_2...P_r \not\subseteq(\alpha)$. Choose $\beta \in P_2...P_r \setminus (\alpha)$.\\
Claim: the element $\gamma = \beta/\alpha$ has the desired property.\\
If $\gamma \in \mathcal{O}_L$, then $\beta = \alpha\gamma \in (\alpha)$, contradiction;\\
$\gamma I = \frac{\beta}{\alpha} I \subseteq \frac{1}{\alpha} P_2...P_r \cdot I \subseteq \frac{1}{\alpha} P_1P_2...P_r \subseteq \mathcal{O}_L$.
\end{proof}
\end{lemma}


\iffalse
\begin{equation*}
\begin{aligned}

\end{aligned}
\end{equation*}
\fi

\end{document}
