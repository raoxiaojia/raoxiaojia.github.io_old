\documentclass[a4paper]{article}

\input{temp}

\setcounter{section}{-1}

\begin{document}

\title{Mathematical Biology}

\maketitle

\newpage

\tableofcontents

\newpage

\section{Miscellaneous}

Course notes online: Julia Gog(www.damtp.cam.ac.uk/research/dd/teaeching, 2013-2017), Peter Haynes(www.damtp.cam.ac.uk/user/phh/mathbio.html)

Moodle page: Handwritten notes by lecture; Matlab/Python programming examples; solved exercises.

This course involves 3 models: Deterministic temporal models (11 lectures), Stochastic temporal models (5 lectures), Deterministic spatio-temporal models (8 lectures).

The focus of this course is biochemical reactions and population processes.

(some introductory speech)

\begin{eg} (1, Transient population)
If we use $n(t)$ to denote the size of a population, we may want to model $\frac{dn}{dt} = f(n)$ by an ODE, or maybe if we have several components $\mathbf{n}(t)$ then we may want to model $\frac{d\mathbf{n}}{dt} = \mathbf{f}(\mathbf{n})$ which is a system of ODEs.

Note that although $n$ should be an integer (discrete), when $n >> 1$ we may model it with continuous equations.
\end{eg}

\begin{eg} (2)
$n \to \partial_t P(n,t) = W \cdot P(n,t)$, Markov processes. Here $P(n,t)$ is a probablity(?), $n$ being a state, and $W$ being the transition matrix.
\end{eg}

\begin{eg} (3)\\
If we include spatial aspect, we may have $n(t)$ becoming $n(x,t)$. Now there might be 'diffusion': $\partial_t n(x,t) = f(n(x,t)) + D \nabla^2 (x,t)$ where $\nabla^2 = \frac{\partial^2}{\partial x^2}$; this is the reaction-diffusion equation.
\end{eg}

\newpage

\section{Birth-death models}
The general idea is that we have a population of size $n(t)$; per capita per unit time, we have births of rate $b$ and deaths of rate $d$. Then we can write $$n(t+\Delta t) = n(t) + bn\Delta t - dn \Delta t$$ So we have an ODE $$\frac{dn}{dt} = (b-d)n = rn$$ where $r = b-d$. This has an easy solution $n(t) = n_0 e^{rt}$, assuming $r$ is a constant. We see that if $r$ is positive then the population grows exponentially, and if $r$ is negative then the population decreases to 0 asymptotically.

Now probably $b$ and $d$ are related to $n$ by $b(n) = bn$ and $d(n) = dn^2$ due to competition. Then we have $$\frac{dn}{dt} = bn-dn^2$$ which we can definitely rewrite as $$\frac{dn}{dt}=\alpha n(1-n)$$ by some change of variable on $n$. Now

\begin{equation*}
\begin{aligned}
\frac{dn}{n(1-n)}&=\alpha dt\\
\implies \frac{dn}{n} + \frac{dn}{1-n} &= \alpha dt\\
\implies \ln n - \ln(1-n) &= \alpha t + c\\
\implies n &= \frac{n_0 e^{\alpha t}}{(1-n_0) + n_0 e^{\alpha t}}
\end{aligned}
\end{equation*}
where we are given that $t=0$, $n=n_0$. If $t \gg \frac{1}{\alpha}$, when $t \to \infty$ we have $n(t) \to 1$. Now we can investigate if the population size is stable, and if it has any fixed points.



Let's now define $\mathbf{n} = (n_1,...,n_p)$, i.e. $p$ populations, and $\frac{d\mathbf{n}}{dt} = \mathbf{f}(\mathbf{n})$. If $\mathbf{n}=\mathbf{n}^*$ is a fixed point, then $\frac{d\mathbf{n}}{dt} = 0$, i.e. $\mathbf{f}(\mathbf{n}) = 0$. Now if we apply a small perturbation $\mathbf{n} = \delta\mathbf{n}^* + \delta \mathbf{n}$, i.e.

\begin{equation*}
\begin{aligned}
\frac{d}{dt} \delta \mathbf{n} &= \mathbf{f} (\mathbf{n}^* + \delta \mathbf{n})\\
a&= \mathbf{f} (\mathbf{n}^*) + \frac{\partial f_i}{\partial n_j} \delta_{nj} + \frac{1}{2} \frac{\partial^2 f_i} {\partial n_j \partial n_k} \delta_{n_j} \delta_{n_k}
\end{aligned}
\end{equation*}
So $\frac{d}{dt} \delta \mathbf{n} = J \cdot \partial \mathbf{n}$, so $\delta n(t) = e^{J t} \cdot \delta n(0)$. If $\lambda_i$'s are the eigenvalues of $J$, we consider the real part of $\lambda_i$: if $Re(\lambda_i)<0$, then  if $p\geq 5$ we only have numerical solutions, if $3 \leq p \leq 5$ we have analytic solutions, and $p=2$ is an easy case (recall $p$ is the number of populations):

$\bullet$ If $p=2$, $\mathbf{n} = (n_1,n_2)$, then 
\begin{equation*}
\begin{aligned}
\frac{d}{dt} \begin{pmatrix} \delta_{n_1} \\
\delta_{n_2}
\end{pmatrix} = \begin{pmatrix}
\frac{\partial f_1}{\partial n_1} & \frac{\partial f_1}{\partial n_2}\\
\frac{\partial f_2}{\partial n_1} & \frac{\partial f_2}{\partial n_2}
\end{pmatrix} \cdot \begin{pmatrix}
\delta_{n_1}\\
\delta_{n_2}
\end{pmatrix}
\end{aligned}
\end{equation*}
Where the matrix is $J$. Now we have $\lambda_1\lambda_2 =\det J$ and $\lambda_1 + \lambda_2 = \tr J$. Determined by the signs of those two, we have different possible behaviours:

\includegraphics[scale=0.5]{image/Bio_01.png}

Now let's consider the spread of Dengue. There are several processes going on at the same time:

(1) Mosquitos carry dengue;\\
(2) Wolbachia infect mosquitos;\\
(3) Infected mosquitos do not transmit dengue;\\
(4) Wolbachia transmission only across generations.

Question: will an intially infected population of mosquitos eventually spread over the entire population as $t \to \infty$?

\includegraphics[scale=0.7]{image/Bio_02.png}

\includegraphics[scale=0.5]{image/Bio_03.png}

We always assume that there are enough males to fertilise the female eggs.

Now consider $\frac{d}{dt}$ of $n_U$ and $n_I$ (uninfected and infected females). From the above tables we should be able to get (hopefully)

\begin{equation*}
\begin{aligned}
\frac{d}{dt} n_U &= r n_U \frac{n_U}{n_U + n_I} - dn_U - \varepsilon (n_U+n_I) n_U\\
\frac{d}{dt} n_I &= \lambda r n_I \frac{n_U}{n_U + n_I} + \lambda r n_I \frac{n_I}{n_U + n_I} - \mu d n_I - \varepsilon (n_U+n_I) n_I \ (*)
\end{aligned}
\end{equation*}
This is our model when $p=2$. The term with $\varepsilon$ is the death rate associated with competition.

We'll try to simplify these equations. By rescaling the time as $t \to rt$, and rescaling the population as $n \to \frac{\varepsilon}{r} n$, we get (?)
\begin{equation*}
\begin{aligned}
\frac{d}{dt} n_U &= n_U \frac{n_U}{n_U + n_I} - \frac{d}{r} n_U - (n_U+n_I) n_U\\
&= n_U\left[\frac{n_U}{n_U+n_I} - \frac{d}{r} - (n_U+n_I)\right] \ (1)
\end{aligned}
\end{equation*}
and the second equation becomes (???)
\begin{equation*}
\begin{aligned}
\frac{d}{dt} n_I = n_I \left[\lambda - \mu \frac{d}{r} - (n_U+n_I)\right] \ (2)
\end{aligned}
\end{equation*}

We'd like to see that the model has at least the fixed points $\mathbf{n}^* = (n^*_U,0)$ and $(0,n^*_I)$. The lecture then somehow defines
\begin{equation*}
\begin{aligned}
n^*_I &= \lambda - \mu \frac{d}{r}\\
n^*_U &= 1-\frac{d}{r}
\end{aligned}
\end{equation*}
so that our differential equations become
\begin{equation*}
\begin{aligned}
\frac{d}{dt} n_U &= n_U \left[n^*_U - \frac{n_I}{n_U+n_I} - (n_U+n_I)\right]\\
\frac{d}{dt} n_I &= n_I \left[n^*_ - (n_U+n_I)\right]
\end{aligned}
\end{equation*}
which has fixed points $(0,0),(n^*_U,0),(0,n^*_I),(n^*_I(1-n^*_I-n^*_U),n^*_I(n^*_U-n^*_I))$. The first is unstable, the second two are stable and the last fixed point is a saddle. This is disappointing because we want a small infection to be spread out to the whole population, but in that case the second fixed point needs to be unstable.

Global analysis:

We can plot the flow of the ode system
\begin{equation*}
\begin{aligned}
\frac{d}{dt} {n_U \choose n_I} = {{f_U(n_U,n_I)} \choose {f_I(n_U,n_I)}}
\end{aligned}
\end{equation*}
This is usually done by programming. We'll try to sketch the flow of this model:

\includegraphics[scale=0.5]{image/Bio_04.png}

Qualitative behaviour: we need a finite (large) $n_I(0)$ (in order to converge to $(n^*_I,0)$).

For quantitative part we can only do numerical integrations.

Now we consider an epidemic model, where each individual may pass through three phases: susceptibles, infectives, recovered (compartment models -- same individual for different phases). We use $S(t),I(t),R(t)$ to denote the population of each of them. 

\includegraphics[scale=0.5]{image/Bio_05.png}

Now we want to know what is the rate of their change. We use biological datum, from which we know there is a per capita infection rate $\beta$, a recovery rate $\nu$, so in conclusion we have
\begin{equation*}
\begin{aligned}
\frac{d}{dt} S &= -\beta SI\\
\frac{d}{dt} I &= \beta SI - \nu I\\
\frac{d}{dt} R &= \nu 
\end{aligned}
\end{equation*}
Also we expect the population to be closed, i.e. the total population should not change over time (unlike the previous model), so 
\begin{equation*}
\begin{aligned}
\frac{d}{dt}(S+I+R) = 0
\end{aligned}
\end{equation*}
Which is true. So it's sufficient to look at just two equations,
\begin{equation*}
\begin{aligned}
\frac{dS}{dt} &= -\beta SI\\
\frac{dI}{dt} &= \beta SI - \nu I
\end{aligned}
\end{equation*}
What are the questions we want to ask? We may want to know:\\
$\bullet$ When can you have an \emph{outbreak}, i.e. $\frac{dI}{dt}>0$;\\
$\bullet$ What is the final size of the outbreak?\\
$\bullet$ What vaccination strategy would work best?\\
$\bullet$ Endemic $\implies I^*>0$, finite number of $I$ in steady state.

For obvious reason we call this the "SIR model".

(Q1)\\
at $t=0$, $\frac{d}{dt}I = [\beta S(0) - \nu] \cdot I(0)$, so $\frac{\beta}{\mu}S(0) > 1 \implies \frac{\beta N}{\nu}>1 = \mathcal{R}_0$, the reproduction ratio, or the mean number of susceptibles infected per infective. 

(Q2)\\
\includegraphics[scale=0.5]{image/Bio_06.png}
\includegraphics[scale=0.5]{image/Bio_07.png}
We had $dS = -\beta SI dt$, $dI = (\beta SI - \nu I) dt$, so
\begin{equation*}
\begin{aligned}
\frac{dI}{dS} &= \frac{(\beta SI - \nu I)}{-\beta SI} = -1 + \frac{\nu}{\beta} \cdot \frac{1}{S}\\
&= \frac{N}{\mathcal{R}_0} \cdot \frac{1}{S} - 1
\end{aligned}
\end{equation*}
So
\begin{equation*}
\begin{aligned}
I=\frac{N}{\mathcal{R}_0} \ln S - S + \text{ const}
\end{aligned}
\end{equation*}
Now $I(t)-I(0) = \frac{N}{\mathcal{R}_0} \ln \frac{S(t)}{S(0)} - (S(t)-S(0))$. As $t \to \infty$, $S(t) = \sigma N$ ($\sigma < 1$, $I(t) \to 0$. So
\begin{equation*}
\begin{aligned}
0 &= \frac{N}{\mathcal{R}_0} \ln \sigma - (\sigma N-N)\\
\sigma - \frac{1}{\mathcal{R}_0} \ln \sigma &= 1
\end{aligned}
\end{equation*}
We can rewrite the second equation as $\mathcal{R}_0 (\sigma-1) = \ln \sigma$. Clear $\sigma = 1$ is a solution, but we are not interested in that. For $\mathcal{R}_0 \gg 1$, $\sigma \approx e^{-\mathcal{R}_0}$.(by sketching curves below and analyze intersections?)
\includegraphics[scale=0.5]{image/Bio_08.png}

Insight: in any epidemic, only a fraction of the population is infected. Size of the epidemic = $(1-\sigma)N$.

(Q3)\\
Vaccination? We can use pre-vaccination, i.e. vaccinate in anticipation of an outbreak. Let $p$ be the fraction of the population being vaccinated. At $t=0$ we have
\begin{equation*}
\begin{aligned}
S(0) \approx (1-p)N\\
\frac{\beta}{\nu} S(0) > 1 \implies \frac{\beta}{\nu} (1-p)N = (1-p)\mathcal{R_0} > 1
\end{aligned}
\end{equation*}
so $p>1-\frac{1}{\mathcal{R}_0}$.
\includegraphics[scale=0.5]{image/Bio_09.png}

(Q4)\\
Endemic: $I(t) \to I^* > 0$ as $t \to \infty$.

\iffalse

\begin{equation*}
\begin{aligned}

\end{aligned}
\end{equation*}
\fi


\end{document}
